
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../custom_network_manager/">
      
      
        <link rel="next" href="../discoverer/">
      
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>Managing Sessions - NetBuff</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/style.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#manging-sessions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="NetBuff" class="md-header__button md-logo" aria-label="NetBuff" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NetBuff
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Managing Sessions
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="NetBuff" class="md-nav__button md-logo" aria-label="NetBuff" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    NetBuff
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Components
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../transports/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Transport
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom_behaviours/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating Custom Behaviours
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../scene_management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scene Management
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../object_spawning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spawning Objects
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom_network_manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom Network Manager
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Managing Sessions
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Managing Sessions
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#establishing-a-session" class="md-nav__link">
    <span class="md-ellipsis">
      Establishing a Session
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-the-session" class="md-nav__link">
    <span class="md-ellipsis">
      Creating the Session
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-restoration" class="md-nav__link">
    <span class="md-ellipsis">
      Session Restoration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#handling-session-data" class="md-nav__link">
    <span class="md-ellipsis">
      Handling Session Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#full-session-management-example" class="md-nav__link">
    <span class="md-ellipsis">
      Full Session Management Example
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../discoverer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Discoverer
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reconnection_and_hot_reload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reconnection and Hot-Reload
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Actions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing the Network
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../samples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Samples
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common Troubleshooting
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#establishing-a-session" class="md-nav__link">
    <span class="md-ellipsis">
      Establishing a Session
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-the-session" class="md-nav__link">
    <span class="md-ellipsis">
      Creating the Session
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-restoration" class="md-nav__link">
    <span class="md-ellipsis">
      Session Restoration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#handling-session-data" class="md-nav__link">
    <span class="md-ellipsis">
      Handling Session Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#full-session-management-example" class="md-nav__link">
    <span class="md-ellipsis">
      Full Session Management Example
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="manging-sessions">Manging Sessions</h1>
<p>Everytime a client connects to the server a new <a class="api-docs">SessionData</a> is created. The session is used to store the client's custom data, such as nickname, score, team, etc. The session is not bound to client object itself, but to the client id itself. You can customize the session management implementing a custom <a class="api-docs">NetworkManager</a> class. In this guide, we will show you how to create a custom session management system.</p>
<h2 id="establishing-a-session">Establishing a Session</h2>
<p>When a client connects, a <a class="api-docs">NetworkSessionEstablishRequestPacket</a> is sent to the server. The method <a class="api-docs">NetworkManager.OnCreateSessionEstablishRequest</a> can be used to create a custom session establish packet:</p>
<div class="language-csharp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">NetworkSessionEstablishRequestPacket</span><span class="w"> </span><span class="nf">OnCreateSessionEstablishRequest</span><span class="p">()</span>
</span><span id="__span-0-2"><span class="p">{</span>
</span><span id="__span-0-3"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ExampleNetworkSessionEstablishRequestPacket</span>
</span><span id="__span-0-4"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-0-5"><span class="w">        </span><span class="n">ShouldBeAccepted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shouldBeAccepted</span><span class="p">.</span><span class="n">isOn</span><span class="p">,</span>
</span><span id="__span-0-6"><span class="w">        </span><span class="n">Nickname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nicknameInput</span><span class="p">.</span><span class="n">text</span>
</span><span id="__span-0-7"><span class="w">    </span><span class="p">};</span>
</span><span id="__span-0-8"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<p>The server receives the packet and can accept or reject the client. The method <a class="api-docs">NetworkManager.OnSessionEstablishingRequest</a> is called when the session is established, accepting or rejecting the client:</p>
<div class="language-csharp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">SessionEstablishingResponse</span><span class="w"> </span><span class="nf">OnSessionEstablishingRequest</span><span class="p">(</span><span class="n">NetworkSessionEstablishRequestPacket</span><span class="w"> </span><span class="n">packet</span><span class="p">)</span>
</span><span id="__span-1-2"><span class="p">{</span>
</span><span id="__span-1-3"><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">examplePacket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ExampleNetworkSessionEstablishRequestPacket</span><span class="p">)</span><span class="w"> </span><span class="n">packet</span><span class="p">;</span>
</span><span id="__span-1-4">
</span><span id="__span-1-5"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">examplePacket</span><span class="p">.</span><span class="n">ShouldBeAccepted</span><span class="p">)</span>
</span><span id="__span-1-6"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SessionEstablishingResponse</span>
</span><span id="__span-1-7"><span class="w">        </span><span class="p">{</span>
</span><span id="__span-1-8"><span class="w">            </span><span class="n">Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SessionEstablishingResponse</span><span class="p">.</span><span class="n">SessionEstablishingResponseType</span><span class="p">.</span><span class="n">Accept</span><span class="p">,</span>
</span><span id="__span-1-9"><span class="w">        </span><span class="p">};</span>
</span><span id="__span-1-10">
</span><span id="__span-1-11"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SessionEstablishingResponse</span>
</span><span id="__span-1-12"><span class="w">        </span><span class="p">{</span>
</span><span id="__span-1-13"><span class="w">            </span><span class="n">Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SessionEstablishingResponse</span><span class="p">.</span><span class="n">SessionEstablishingResponseType</span><span class="p">.</span><span class="n">Reject</span><span class="p">,</span>
</span><span id="__span-1-14"><span class="w">            </span><span class="n">Reason</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;just_testing&quot;</span>
</span><span id="__span-1-15"><span class="w">        </span><span class="p">};</span>
</span><span id="__span-1-16"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<h2 id="creating-the-session">Creating the Session</h2>
<p>After a session is established, the method <a class="api-docs">NetworkManager.OnCreateNewSessionData</a> is called. This method is used to create the session object using the <a class="api-docs">NetworkSessionEstablishRequestPacket</a> used to establish the session:</p>
<div class="language-csharp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">SessionData</span><span class="w"> </span><span class="nf">OnCreateNewSessionData</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">clientId</span><span class="p">,</span><span class="w"> </span><span class="n">NetworkSessionEstablishRequestPacket</span><span class="w"> </span><span class="n">packet</span><span class="p">)</span>
</span><span id="__span-2-2"><span class="p">{</span>
</span><span id="__span-2-3"><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">packetData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ExampleNetworkSessionEstablishRequestPacket</span><span class="p">)</span><span class="w"> </span><span class="n">packet</span><span class="p">;</span>
</span><span id="__span-2-4"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ExampleSessionData</span><span class="p">()</span>
</span><span id="__span-2-5"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-2-6"><span class="w">        </span><span class="n">nickname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">packetData</span><span class="p">.</span><span class="n">Nickname</span>
</span><span id="__span-2-7"><span class="w">    </span><span class="p">};</span>
</span><span id="__span-2-8"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<p>After this, the session is created and the server syncs all object states to the client.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You need to override the method <a class="api-docs">NetworkManager.OnCreateEmptySessionData</a> as well:</p>
<div class="language-csharp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">SessionData</span><span class="w"> </span><span class="nf">OnCreateEmptySessionData</span><span class="p">()</span>
</span><span id="__span-3-2"><span class="p">{</span>
</span><span id="__span-3-3"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ExampleSessionData</span><span class="p">();</span>
</span><span id="__span-3-4"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
</div>
<h2 id="session-restoration">Session Restoration</h2>
<p>If the option <a class="api-docs">NetworkManager.SupportsSessionRestoration</a> is enabled, the server will try to restore the client's session after a hot-reload. The method <a class="api-docs">NetworkManager.OnRestoreSessionData</a> is called to restore the session data:</p>
<div class="language-csharp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">SessionData</span><span class="w"> </span><span class="nf">OnRestoreSessionData</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">clientId</span><span class="p">,</span><span class="w"> </span><span class="n">NetworkSessionEstablishRequestPacket</span><span class="w"> </span><span class="n">packet</span><span class="p">)</span>
</span><span id="__span-4-2"><span class="p">{</span>
</span><span id="__span-4-3"><span class="w">    </span><span class="c1">//Keeps the session using the nickname</span>
</span><span id="__span-4-4"><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">packetData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ExampleNetworkSessionEstablishRequestPacket</span><span class="p">)</span><span class="w"> </span><span class="n">packet</span><span class="p">;</span>
</span><span id="__span-4-5"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">GetAllDisconnectedSessionData</span><span class="o">&lt;</span><span class="n">ExampleSessionData</span><span class="o">&gt;</span><span class="p">().</span><span class="n">FirstOrDefault</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="n">nickname</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">packetData</span><span class="p">.</span><span class="n">Nickname</span><span class="p">);</span>
</span><span id="__span-4-6"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<p>If no session is found (returns null), the method <a class="api-docs">NetworkManager.OnCreateEmptySessionData</a> is called to create a new session.</p>
<p>By default, the <a class="api-docs">NetworkManager</a> uses the client id to restore the session, so after a hot-reload, the client will be able to restore its session.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The client id increases after each connection, so if you are using the client id to restore the session, you should not rely on it to store any important data. If a client connects the disconnects and connects again, his id may not be the same after a hot-reload. We heavily recommend using another key to store the session data, such as the client's nickname.</p>
</div>
<h2 id="handling-session-data">Handling Session Data</h2>
<p>The session data is stored in A <a class="api-docs">SessionData</a> object, stored by the server. When the <a class="api-docs">SessionData</a> is created, it's content is synced to the client. The local <a class="api-docs">SessionData</a> object can be accessed using the <a class="api-docs">NetworkManager.GetLocalSessionData</a> method.</p>
<p>Only the server may change the session data contents, and after a change, the server needs to call the <a class="api-docs">SessionData.ApplyChanges</a> method to sync the changes to the client:</p>
<div class="language-csharp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">()</span>
</span><span id="__span-5-2"><span class="p">{</span>
</span><span id="__span-5-3"><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">IsServerRunning</span><span class="p">)</span>
</span><span id="__span-5-4"><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-5-5">
</span><span id="__span-5-6"><span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">sessionData</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">GetAllSessionData</span><span class="o">&lt;</span><span class="n">ExampleSessionData</span><span class="o">&gt;</span><span class="p">())</span>
</span><span id="__span-5-7"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-5-8"><span class="w">        </span><span class="n">sessionData</span><span class="p">.</span><span class="n">someInt</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-5-9"><span class="w">        </span><span class="c1">//Sync data to the client</span>
</span><span id="__span-5-10"><span class="w">        </span><span class="n">sessionData</span><span class="p">.</span><span class="n">ApplyChanges</span><span class="p">();</span>
</span><span id="__span-5-11"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-12"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<p>The method <a class="api-docs">NetworkManager.OnLocalSessionDataChanged</a> is called automatically when the client receives the session data changes:</p>
<div class="language-csharp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnLocalSessionDataChanged</span><span class="p">(</span><span class="n">SessionData</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
</span><span id="__span-6-2"><span class="p">{</span>
</span><span id="__span-6-3"><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">exampleSessionData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetLocalSessionData</span><span class="o">&lt;</span><span class="n">ExampleSessionData</span><span class="o">&gt;</span><span class="p">();</span>
</span><span id="__span-6-4"><span class="w">    </span><span class="c1">//var exampleSessionData = (ExampleSessionData) data;</span>
</span><span id="__span-6-5">
</span><span id="__span-6-6"><span class="w">    </span><span class="n">Debug</span><span class="p">.</span><span class="n">LogError</span><span class="p">(</span><span class="s">$&quot;Test: {exampleSessionData.someInt}&quot;</span><span class="p">);</span>
</span><span id="__span-6-7"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<h2 id="full-session-management-example">Full Session Management Example</h2>
<div class="language-csharp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><span class="k">namespace</span><span class="w"> </span><span class="nn">Samples.SessionDataTesting.Scripts</span>
</span><span id="__span-7-2"><span class="p">{</span>
</span><span id="__span-7-3"><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">SessionDataTestingNetworkManager</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">NetworkManager</span>
</span><span id="__span-7-4"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-7-5"><span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="n">InputField</span><span class="w"> </span><span class="n">nicknameInput</span><span class="p">;</span>
</span><span id="__span-7-6"><span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="n">Toggle</span><span class="w"> </span><span class="n">shouldBeAccepted</span><span class="p">;</span>
</span><span id="__span-7-7">
</span><span id="__span-7-8"><span class="w">        </span><span class="cp">#region Session Establishing</span>
</span><span id="__span-7-9"><span class="w">        </span><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">NetworkSessionEstablishRequestPacket</span><span class="w"> </span><span class="nf">OnCreateSessionEstablishRequest</span><span class="p">()</span>
</span><span id="__span-7-10"><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-11"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ExampleNetworkSessionEstablishRequestPacket</span>
</span><span id="__span-7-12"><span class="w">            </span><span class="p">{</span>
</span><span id="__span-7-13"><span class="w">                </span><span class="n">ShouldBeAccepted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shouldBeAccepted</span><span class="p">.</span><span class="n">isOn</span><span class="p">,</span>
</span><span id="__span-7-14"><span class="w">                </span><span class="n">Nickname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nicknameInput</span><span class="p">.</span><span class="n">text</span>
</span><span id="__span-7-15"><span class="w">            </span><span class="p">};</span>
</span><span id="__span-7-16"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-17">
</span><span id="__span-7-18"><span class="w">        </span><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">SessionEstablishingResponse</span><span class="w"> </span><span class="nf">OnSessionEstablishingRequest</span><span class="p">(</span><span class="n">NetworkSessionEstablishRequestPacket</span><span class="w"> </span><span class="n">packet</span><span class="p">)</span>
</span><span id="__span-7-19"><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-20"><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">examplePacket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ExampleNetworkSessionEstablishRequestPacket</span><span class="p">)</span><span class="w"> </span><span class="n">packet</span><span class="p">;</span>
</span><span id="__span-7-21">
</span><span id="__span-7-22"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">examplePacket</span><span class="p">.</span><span class="n">ShouldBeAccepted</span><span class="p">)</span>
</span><span id="__span-7-23"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SessionEstablishingResponse</span>
</span><span id="__span-7-24"><span class="w">                </span><span class="p">{</span>
</span><span id="__span-7-25"><span class="w">                    </span><span class="n">Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SessionEstablishingResponse</span><span class="p">.</span><span class="n">SessionEstablishingResponseType</span><span class="p">.</span><span class="n">Accept</span><span class="p">,</span>
</span><span id="__span-7-26"><span class="w">                </span><span class="p">};</span>
</span><span id="__span-7-27">
</span><span id="__span-7-28"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SessionEstablishingResponse</span>
</span><span id="__span-7-29"><span class="w">                </span><span class="p">{</span>
</span><span id="__span-7-30"><span class="w">                    </span><span class="n">Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SessionEstablishingResponse</span><span class="p">.</span><span class="n">SessionEstablishingResponseType</span><span class="p">.</span><span class="n">Reject</span><span class="p">,</span>
</span><span id="__span-7-31"><span class="w">                    </span><span class="n">Reason</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;just_testing&quot;</span>
</span><span id="__span-7-32"><span class="w">                </span><span class="p">};</span>
</span><span id="__span-7-33"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-34"><span class="w">        </span><span class="cp">#endregion</span>
</span><span id="__span-7-35">
</span><span id="__span-7-36">
</span><span id="__span-7-37"><span class="w">        </span><span class="cp">#region Session Data Restoring</span>
</span><span id="__span-7-38"><span class="w">        </span><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">SessionData</span><span class="w"> </span><span class="nf">OnRestoreSessionData</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">clientId</span><span class="p">,</span><span class="w"> </span><span class="n">NetworkSessionEstablishRequestPacket</span><span class="w"> </span><span class="n">packet</span><span class="p">)</span>
</span><span id="__span-7-39"><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-40"><span class="w">            </span><span class="c1">//Keeps the session using the nickname</span>
</span><span id="__span-7-41"><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">packetData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ExampleNetworkSessionEstablishRequestPacket</span><span class="p">)</span><span class="w"> </span><span class="n">packet</span><span class="p">;</span>
</span><span id="__span-7-42"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">GetAllDisconnectedSessionData</span><span class="o">&lt;</span><span class="n">ExampleSessionData</span><span class="o">&gt;</span><span class="p">().</span><span class="n">FirstOrDefault</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="n">nickname</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">packetData</span><span class="p">.</span><span class="n">Nickname</span><span class="p">);</span>
</span><span id="__span-7-43"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-44"><span class="w">        </span><span class="cp">#endregion</span>
</span><span id="__span-7-45">
</span><span id="__span-7-46"><span class="w">        </span><span class="cp">#region Session Data Creation</span>
</span><span id="__span-7-47"><span class="w">        </span><span class="c1">//Server Side</span>
</span><span id="__span-7-48"><span class="w">        </span><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">SessionData</span><span class="w"> </span><span class="nf">OnCreateNewSessionData</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">clientId</span><span class="p">,</span><span class="w"> </span><span class="n">NetworkSessionEstablishRequestPacket</span><span class="w"> </span><span class="n">packet</span><span class="p">)</span>
</span><span id="__span-7-49"><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-50"><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">packetData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ExampleNetworkSessionEstablishRequestPacket</span><span class="p">)</span><span class="w"> </span><span class="n">packet</span><span class="p">;</span>
</span><span id="__span-7-51"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ExampleSessionData</span><span class="p">()</span>
</span><span id="__span-7-52"><span class="w">            </span><span class="p">{</span>
</span><span id="__span-7-53"><span class="w">                </span><span class="n">nickname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">packetData</span><span class="p">.</span><span class="n">Nickname</span>
</span><span id="__span-7-54"><span class="w">            </span><span class="p">};</span>
</span><span id="__span-7-55"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-56">
</span><span id="__span-7-57"><span class="w">        </span><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">SessionData</span><span class="w"> </span><span class="nf">OnCreateEmptySessionData</span><span class="p">()</span>
</span><span id="__span-7-58"><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-59"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ExampleSessionData</span><span class="p">();</span>
</span><span id="__span-7-60"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-61"><span class="w">        </span><span class="cp">#endregion</span>
</span><span id="__span-7-62">
</span><span id="__span-7-63"><span class="w">        </span><span class="cp">#region Session Data Manipulation</span>
</span><span id="__span-7-64"><span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">()</span>
</span><span id="__span-7-65"><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-66"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="p">.</span><span class="n">frameCount</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
</span><span id="__span-7-67"><span class="w">                </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-7-68">
</span><span id="__span-7-69"><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">IsServerRunning</span><span class="p">)</span>
</span><span id="__span-7-70"><span class="w">                </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-7-71">
</span><span id="__span-7-72"><span class="w">            </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">sessionData</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">GetAllSessionData</span><span class="o">&lt;</span><span class="n">ExampleSessionData</span><span class="o">&gt;</span><span class="p">())</span>
</span><span id="__span-7-73"><span class="w">            </span><span class="p">{</span>
</span><span id="__span-7-74"><span class="w">                </span><span class="n">sessionData</span><span class="p">.</span><span class="n">someInt</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-7-75"><span class="w">                </span><span class="c1">//Sync data to the client</span>
</span><span id="__span-7-76"><span class="w">                </span><span class="n">sessionData</span><span class="p">.</span><span class="n">ApplyChanges</span><span class="p">();</span>
</span><span id="__span-7-77"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-7-78"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-79">
</span><span id="__span-7-80"><span class="w">        </span><span class="c1">//Client Side</span>
</span><span id="__span-7-81"><span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnLocalSessionDataChanged</span><span class="p">(</span><span class="n">SessionData</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
</span><span id="__span-7-82"><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-83"><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">exampleSessionData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetLocalSessionData</span><span class="o">&lt;</span><span class="n">ExampleSessionData</span><span class="o">&gt;</span><span class="p">();</span>
</span><span id="__span-7-84"><span class="w">            </span><span class="c1">//var exampleSessionData = (ExampleSessionData) data;</span>
</span><span id="__span-7-85">
</span><span id="__span-7-86"><span class="w">            </span><span class="n">Debug</span><span class="p">.</span><span class="n">LogError</span><span class="p">(</span><span class="s">$&quot;Test: {exampleSessionData.someInt}&quot;</span><span class="p">);</span>
</span><span id="__span-7-87"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-88"><span class="w">        </span><span class="cp">#endregion</span>
</span><span id="__span-7-89"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-7-90">
</span><span id="__span-7-91"><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ExampleNetworkSessionEstablishRequestPacket</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">NetworkSessionEstablishRequestPacket</span>
</span><span id="__span-7-92"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-7-93"><span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">ShouldBeAccepted</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-7-94"><span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Nickname</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-7-95">
</span><span id="__span-7-96"><span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Serialize</span><span class="p">(</span><span class="n">BinaryWriter</span><span class="w"> </span><span class="n">writer</span><span class="p">)</span>
</span><span id="__span-7-97"><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-98"><span class="w">            </span><span class="n">writer</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">ShouldBeAccepted</span><span class="p">);</span>
</span><span id="__span-7-99"><span class="w">            </span><span class="n">writer</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">Nickname</span><span class="p">);</span>
</span><span id="__span-7-100"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-101">
</span><span id="__span-7-102"><span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Deserialize</span><span class="p">(</span><span class="n">BinaryReader</span><span class="w"> </span><span class="n">reader</span><span class="p">)</span>
</span><span id="__span-7-103"><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-104"><span class="w">            </span><span class="n">ShouldBeAccepted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="n">ReadBoolean</span><span class="p">();</span>
</span><span id="__span-7-105"><span class="w">            </span><span class="n">Nickname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="n">ReadString</span><span class="p">();</span>
</span><span id="__span-7-106"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-107"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-7-108">
</span><span id="__span-7-109"><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ExampleSessionData</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">SessionData</span>
</span><span id="__span-7-110"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-7-111"><span class="w">        </span><span class="c1">//Doesn&#39;t needs to be synced to the client</span>
</span><span id="__span-7-112"><span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">nickname</span><span class="p">;</span>
</span><span id="__span-7-113">
</span><span id="__span-7-114"><span class="w">        </span><span class="c1">//Needs to be synced to the client</span>
</span><span id="__span-7-115"><span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">someInt</span><span class="p">;</span>
</span><span id="__span-7-116">
</span><span id="__span-7-117"><span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Serialize</span><span class="p">(</span><span class="n">BinaryWriter</span><span class="w"> </span><span class="n">writer</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">shouldSerializeEverything</span><span class="p">)</span>
</span><span id="__span-7-118"><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-119"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">shouldSerializeEverything</span><span class="p">)</span>
</span><span id="__span-7-120"><span class="w">                </span><span class="n">writer</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">nickname</span><span class="p">);</span>
</span><span id="__span-7-121"><span class="w">            </span><span class="n">writer</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">someInt</span><span class="p">);</span>
</span><span id="__span-7-122"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-123">
</span><span id="__span-7-124"><span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Deserialize</span><span class="p">(</span><span class="n">BinaryReader</span><span class="w"> </span><span class="n">reader</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">shouldDeserializeEverything</span><span class="p">)</span>
</span><span id="__span-7-125"><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-126"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">shouldDeserializeEverything</span><span class="p">)</span>
</span><span id="__span-7-127"><span class="w">                </span><span class="n">nickname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="n">ReadString</span><span class="p">();</span>
</span><span id="__span-7-128"><span class="w">            </span><span class="n">someInt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="n">ReadInt32</span><span class="p">();</span>
</span><span id="__span-7-129"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-130"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-7-131"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parameter shouldSerializeEverything will only be true when the session data is being kept through a hot-reload, so all the data must be serialized.</p>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.select", "content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
        <script src="../js/auto_link.js"></script>
      
    
  </body>
</html>